<mxfile host="app.diagrams.net" modified="2025-10-15T00:00:00.000Z" agent="ServiCiudad Team" version="22.0.0" type="device">
  <diagram name="Arquitectura ServiCiudad" id="arquitectura-serviciudad">
    <mxGraphModel dx="1422" dy="762" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Titulo -->
        <mxCell id="titulo" value="ARQUITECTURA SERVICIUDAD CALI - SISTEMA DE CONSULTA UNIFICADA" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="270" y="20" width="630" height="30" as="geometry" />
        </mxCell>
        
        <!-- Capa de Presentacion -->
        <mxCell id="capa-presentacion" value="CAPA DE PRESENTACION" style="swimlane;startSize=30;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="40" y="70" width="1080" height="180" as="geometry" />
        </mxCell>
        
        <!-- Cliente HTTP -->
        <mxCell id="cliente-http" value="Cliente HTTP/Mobile App&#xa;&#xa;Peticiones REST&#xa;JSON Request/Response" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" vertex="1" parent="capa-presentacion">
          <mxGeometry x="20" y="50" width="180" height="100" as="geometry" />
        </mxCell>
        
        <!-- Controllers -->
        <mxCell id="controller-facturas" value="FacturaAcueductoController&#xa;&#xa;@RestController&#xa;12 endpoints REST&#xa;/api/facturas/*" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="capa-presentacion">
          <mxGeometry x="240" y="50" width="200" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="controller-energia" value="ConsumoEnergiaController&#xa;&#xa;@RestController&#xa;6 endpoints REST&#xa;/api/consumos-energia/*" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="capa-presentacion">
          <mxGeometry x="470" y="50" width="200" height="100" as="geometry" />
        </mxCell>
        
        <!-- Exception Handler -->
        <mxCell id="exception-handler" value="GlobalExceptionHandler&#xa;&#xa;@ControllerAdvice&#xa;6 exception handlers&#xa;HTTP 4xx/5xx" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="capa-presentacion">
          <mxGeometry x="700" y="50" width="180" height="100" as="geometry" />
        </mxCell>
        
        <!-- DTOs -->
        <mxCell id="dtos" value="DTOs&#xa;&#xa;Request/Response/General&#xa;Builder Pattern&#xa;Bean Validation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="capa-presentacion">
          <mxGeometry x="910" y="50" width="140" height="100" as="geometry" />
        </mxCell>
        
        <!-- Flechas Cliente -> Controllers -->
        <mxCell id="arrow-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="capa-presentacion" source="cliente-http" target="controller-facturas">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.75;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;" edge="1" parent="capa-presentacion" source="cliente-http" target="controller-energia">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Capa de Negocio -->
        <mxCell id="capa-negocio" value="CAPA DE NEGOCIO (Service Layer)" style="swimlane;startSize=30;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="40" y="280" width="1080" height="200" as="geometry" />
        </mxCell>
        
        <!-- Services -->
        <mxCell id="service-facturas" value="FacturaAcueductoService&#xa;&#xa;@Service&#xa;Logica de negocio&#xa;13 metodos&#xa;@Transactional" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="capa-negocio">
          <mxGeometry x="60" y="50" width="200" height="120" as="geometry" />
        </mxCell>
        
        <mxCell id="builder-deuda" value="DeudaConsolidadaBuilder&#xa;&#xa;@Component&#xa;Builder Pattern&#xa;Construccion fluida DTOs&#xa;10 metodos" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="capa-negocio">
          <mxGeometry x="290" y="50" width="200" height="120" as="geometry" />
        </mxCell>
        
        <mxCell id="mapper" value="FacturaMapper&#xa;&#xa;@Component&#xa;Entity &lt;-&gt; DTO&#xa;4 metodos transformacion&#xa;Enriquecimiento" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="capa-negocio">
          <mxGeometry x="520" y="50" width="180" height="120" as="geometry" />
        </mxCell>
        
        <!-- Domain Models -->
        <mxCell id="domain-models" value="Domain Models&#xa;&#xa;FacturaAcueducto (@Entity)&#xa;ConsumoEnergia (POJO)&#xa;EstadoFactura (Enum)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="capa-negocio">
          <mxGeometry x="730" y="50" width="180" height="120" as="geometry" />
        </mxCell>
        
        <!-- IoC/DI Annotation -->
        <mxCell id="ioc-annotation" value="IoC/DI Pattern&#xa;Constructor Injection&#xa;@RequiredArgsConstructor" style="text;html=1;strokeColor=#6c8ebf;fillColor=#dae8fc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=10;fontStyle=2;" vertex="1" parent="capa-negocio">
          <mxGeometry x="940" y="80" width="120" height="60" as="geometry" />
        </mxCell>
        
        <!-- Flechas Presentacion -> Negocio -->
        <mxCell id="arrow-3" value="@Autowired&#xa;Inyeccion Dependencias" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;dashPattern=8 8;" edge="1" parent="1" source="controller-facturas" target="service-facturas">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="380" y="260" as="sourcePoint" />
            <mxPoint x="200" y="330" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- Capa de Persistencia e Integracion -->
        <mxCell id="capa-persistencia" value="CAPA DE PERSISTENCIA E INTEGRACION" style="swimlane;startSize=30;fillColor=#fff2cc;strokeColor=#d6b656;fontStyle=1;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="40" y="510" width="1080" height="180" as="geometry" />
        </mxCell>
        
        <!-- Adapter Pattern -->
        <mxCell id="adapter-energia" value="AdaptadorArchivoEnergia&#xa;&#xa;@Component&#xa;Adapter Pattern&#xa;8 metodos lectura&#xa;Parser COBOL ancho fijo" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="capa-persistencia">
          <mxGeometry x="60" y="50" width="220" height="100" as="geometry" />
        </mxCell>
        
        <!-- Repository Pattern -->
        <mxCell id="repository" value="FacturaAcueductoRepository&#xa;&#xa;@Repository&#xa;Repository Pattern&#xa;extends JpaRepository&#xa;15 custom queries" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="capa-persistencia">
          <mxGeometry x="350" y="50" width="230" height="100" as="geometry" />
        </mxCell>
        
        <!-- Spring Data JPA -->
        <mxCell id="spring-data" value="Spring Data JPA&#xa;&#xa;Query Derivation&#xa;Paginacion/Sorting&#xa;Transacciones" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="capa-persistencia">
          <mxGeometry x="650" y="50" width="160" height="100" as="geometry" />
        </mxCell>
        
        <!-- HikariCP -->
        <mxCell id="hikaricp" value="HikariCP&#xa;&#xa;Connection Pooling&#xa;Max: 10 conexiones&#xa;Min Idle: 5" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="capa-persistencia">
          <mxGeometry x="870" y="50" width="160" height="100" as="geometry" />
        </mxCell>
        
        <!-- Flechas Negocio -> Persistencia -->
        <mxCell id="arrow-4" value="Invoca" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="service-facturas" target="adapter-energia">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="150" y="480" as="sourcePoint" />
            <mxPoint x="170" y="560" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow-5" value="Invoca" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="service-facturas" target="repository">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="210" y="480" as="sourcePoint" />
            <mxPoint x="465" y="560" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- Capa de Datos -->
        <mxCell id="capa-datos" value="CAPA DE DATOS" style="swimlane;startSize=30;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="40" y="720" width="1080" height="130" as="geometry" />
        </mxCell>
        
        <!-- Archivo Legacy -->
        <mxCell id="archivo-legacy" value="consumos_energia.txt&#xa;&#xa;Mainframe IBM Z (simulado)&#xa;Formato COBOL 78 chars&#xa;Ancho fijo&#xa;10 registros prueba" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;" vertex="1" parent="capa-datos">
          <mxGeometry x="60" y="50" width="220" height="60" as="geometry" />
        </mxCell>
        
        <!-- Base de Datos -->
        <mxCell id="database" value="PostgreSQL 15&#xa;&#xa;facturas_acueducto (tabla)&#xa;4 indices B-tree&#xa;20 registros prueba&#xa;ACID transactions" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;" vertex="1" parent="capa-datos">
          <mxGeometry x="400" y="40" width="180" height="80" as="geometry" />
        </mxCell>
        
        <!-- Docker -->
        <mxCell id="docker-note" value="Docker Container&#xa;postgres:15-alpine&#xa;Volume: schema.sql + data.sql" style="text;html=1;strokeColor=#6c8ebf;fillColor=#dae8fc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=10;" vertex="1" parent="capa-datos">
          <mxGeometry x="640" y="55" width="180" height="50" as="geometry" />
        </mxCell>
        
        <!-- Actuator -->
        <mxCell id="actuator-note" value="Spring Boot Actuator&#xa;/actuator/health&#xa;/actuator/metrics&#xa;/actuator/prometheus" style="text;html=1;strokeColor=#82b366;fillColor=#d5e8d4;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=10;" vertex="1" parent="capa-datos">
          <mxGeometry x="870" y="55" width="160" height="50" as="geometry" />
        </mxCell>
        
        <!-- Flechas Persistencia -> Datos -->
        <mxCell id="arrow-6" value="Lee archivo&#xa;Files.readAllLines()" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="adapter-energia" target="archivo-legacy">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="170" y="690" as="sourcePoint" />
            <mxPoint x="170" y="770" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow-7" value="JDBC via&#xa;HikariCP" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="repository" target="database">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="465" y="690" as="sourcePoint" />
            <mxPoint x="490" y="760" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- Leyenda de Patrones -->
        <mxCell id="leyenda" value="PATRONES IMPLEMENTADOS" style="swimlane;startSize=30;fillColor=#e1d5e7;strokeColor=#9673a6;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="1180" y="70" width="250" height="320" as="geometry" />
        </mxCell>
        
        <mxCell id="patron-1" value="1. ADAPTER PATTERN&#xa;AdaptadorArchivoEnergia&#xa;Lee archivo COBOL legacy" style="text;html=1;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;whiteSpace=wrap;rounded=1;fontSize=10;spacing=5;" vertex="1" parent="leyenda">
          <mxGeometry x="10" y="40" width="230" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="patron-2" value="2. BUILDER PATTERN&#xa;DeudaConsolidadaBuilder&#xa;Construccion fluida DTOs" style="text;html=1;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;whiteSpace=wrap;rounded=1;fontSize=10;spacing=5;" vertex="1" parent="leyenda">
          <mxGeometry x="10" y="100" width="230" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="patron-3" value="3. DTO PATTERN&#xa;Request/Response/General&#xa;Desacoplamiento capas" style="text;html=1;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;whiteSpace=wrap;rounded=1;fontSize=10;spacing=5;" vertex="1" parent="leyenda">
          <mxGeometry x="10" y="160" width="230" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="patron-4" value="4. REPOSITORY PATTERN&#xa;Spring Data JPA&#xa;Query derivation automatica" style="text;html=1;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;whiteSpace=wrap;rounded=1;fontSize=10;spacing=5;" vertex="1" parent="leyenda">
          <mxGeometry x="10" y="220" width="230" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="patron-5" value="5. IoC/DI PATTERN&#xa;Spring Framework&#xa;Constructor injection" style="text;html=1;strokeColor=#d6b656;fillColor=#fff2cc;align=left;verticalAlign=top;whiteSpace=wrap;rounded=1;fontSize=10;spacing=5;" vertex="1" parent="leyenda">
          <mxGeometry x="10" y="280" width="230" height="40" as="geometry" />
        </mxCell>
        
        <!-- Stack Tecnologico -->
        <mxCell id="stack" value="STACK TECNOLOGICO" style="swimlane;startSize=30;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="1180" y="410" width="250" height="270" as="geometry" />
        </mxCell>
        
        <mxCell id="stack-items" value="- Spring Boot 3.2.0&#xa;- Java 17 LTS&#xa;- Maven 3.9.11&#xa;- PostgreSQL 15&#xa;- Hibernate 6.3 (JPA)&#xa;- HikariCP 5.0&#xa;- Docker + Compose&#xa;- OpenAPI 3.0 (SpringDoc)&#xa;- JUnit 5 + Mockito&#xa;- Logback + SLF4J&#xa;- Lombok 1.18&#xa;- Spring Actuator" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Courier New;" vertex="1" parent="stack">
          <mxGeometry x="10" y="40" width="230" height="220" as="geometry" />
        </mxCell>
        
        <!-- Metricas -->
        <mxCell id="metricas" value="METRICAS DE CALIDAD" style="swimlane;startSize=30;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="1180" y="700" width="250" height="150" as="geometry" />
        </mxCell>
        
        <mxCell id="metricas-items" value="- Cobertura: 85% lineas&#xa;- Complejidad: 6.2 promedio&#xa;- P95 response: 1.2s&#xa;- Throughput: 120 RPS&#xa;- Error rate: 0.3%&#xa;- Bugs criticos: 0" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;fontFamily=Courier New;" vertex="1" parent="metricas">
          <mxGeometry x="10" y="40" width="230" height="100" as="geometry" />
        </mxCell>
        
        <!-- Nota de Documentacion -->
        <mxCell id="nota-doc" value="Diagrama generado para: INFORME TECNICO - ServiCiudad Cali&#xa;Universidad Autonoma de Occidente - Ingenieria de Software 2&#xa;Equipo: Eduard Criollo, Felipe Charria, Jhonathan Chicaiza, Emmanuel Mena, Juan Sebastian Castillo&#xa;Octubre 2025" style="text;html=1;strokeColor=#666666;fillColor=#f5f5f5;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=9;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="40" y="870" width="1390" height="50" as="geometry" />
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
