<?xml version="1.0" encoding="UTF-8"?>
<mxfile host="app.diagrams.net" modified="2024-01-15T10:00:00.000Z" agent="5.0" version="22.1.16" etag="example" type="device">
  <diagram name="Message Translator Pattern" id="message_translator_pattern">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1654" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- TITLE -->
        <mxCell id="title" value="MESSAGE TRANSLATOR PATTERN - TRANSFORMACIÃ“N DATOS LEGACY SERVICIUDAD" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=18;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="60" y="40" width="1520" height="60" as="geometry" />
        </mxCell>
        
        <!-- LEGACY SYSTEMS DATA FORMATS -->
        <mxCell id="legacy_formats_title" value="FORMATOS DE DATOS SISTEMAS LEGACY" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=16;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="120" width="480" height="40" as="geometry" />
        </mxCell>
        
        <!-- MAINFRAME EBCDIC -->
        <mxCell id="mainframe_format" value="Mainframe IBM Z - EBCDIC" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=14;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="180" width="220" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="ebcdic_sample" value="Registro COBOL (EBCDIC):&#xa;01 CLIENTE-ENERGIA.&#xa;   05 COD-CLIENTE     PIC X(10).&#xa;   05 NOM-CLIENTE     PIC X(50).&#xa;   05 SALDO-ENERGIA   PIC 9(12)V99.&#xa;   05 ESTADO          PIC X(1).&#xa;   05 FECHA-ULT-PAGO  PIC 9(8).&#xa;&#xa;Ejemplo binario EBCDIC:&#xa;F0F0F0F1F2F3...D1D6C8C5..." style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;align=left;fontFamily=monospace;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="80" y="220" width="220" height="160" as="geometry" />
        </mxCell>
        
        <!-- ORACLE FIXED WIDTH -->
        <mxCell id="oracle_format" value="Oracle Solaris - Fixed Width" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=14;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="340" y="180" width="220" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="fixed_width_sample" value="Archivo Fixed Width (PL/SQL Export):&#xa;0000012345JUAN CARLOS RODRIGUEZ MESA    000000150000A20241201&#xa;0000023456MARIA FERNANDA LOPEZ GARCIA   000000080000A20241201&#xa;0000034567CARLOS EDUARDO MARTINEZ RUIZ  000000000000I20241130&#xa;&#xa;Campos:&#xa;Pos 1-10:   CÃ³digo Cliente&#xa;Pos 11-50:  Nombre Cliente&#xa;Pos 51-62:  Saldo (12 dÃ­gitos)&#xa;Pos 63:     Estado (A/I)&#xa;Pos 64-71:  Fecha Ãºltima consulta" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;align=left;fontFamily=monospace;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="340" y="220" width="220" height="160" as="geometry" />
        </mxCell>
        
        <!-- MESSAGE TRANSLATORS -->
        <mxCell id="translator_title" value="MESSAGE TRANSLATORS (CAPA ANTICORRUPCIÃ“N)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=16;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="640" y="120" width="480" height="40" as="geometry" />
        </mxCell>
        
        <!-- EBCDIC TRANSLATOR -->
        <mxCell id="ebcdic_translator" value="EBCDIC to JSON Translator" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=14;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="640" y="180" width="220" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="ebcdic_translator_code" value="@Component&#xa;public class ServiCiudadEbcdicTranslator {&#xa;    &#xa;    @Autowired&#xa;    private EbcdicDecoder ebcdicDecoder;&#xa;    &#xa;    public ClienteEnergiaDTO translate(&#xa;        byte[] mainframeData) {&#xa;        &#xa;        // Decodificar EBCDIC IBM Z a ASCII&#xa;        String asciiData = ebcdicDecoder&#xa;            .decode(mainframeData);&#xa;        &#xa;        // Parsear campos COBOL especÃ­ficos&#xa;        return ClienteEnergiaDTO.builder()&#xa;            .codigoServiCiudad(asciiData&#xa;                .substring(0,10))&#xa;            .nombreCompleto(asciiData&#xa;                .substring(10,60).trim())&#xa;            .saldoEnergia(parseCurrencyCOP(&#xa;                asciiData.substring(60,74)))&#xa;            .estadoServicio(parseEstado(&#xa;                asciiData.charAt(74)))&#xa;            .fechaUltimoPago(parseDate(&#xa;                asciiData.substring(75,83)))&#xa;            .build();&#xa;    }&#xa;}" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;align=left;fontFamily=monospace;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="640" y="220" width="220" height="160" as="geometry" />
        </mxCell>
        
        <!-- FIXED WIDTH TRANSLATOR -->
        <mxCell id="fixed_translator" value="Fixed Width to JSON Translator" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=14;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="900" y="180" width="220" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="fixed_translator_code" value="@Component&#xa;public class FixedWidthToJsonTranslator {&#xa;    &#xa;    private final FixedWidthParser parser;&#xa;    &#xa;    public ClienteAcueductoDTO translate(&#xa;        String fixedWidthLine) {&#xa;        &#xa;        return ClienteAcueductoDTO.builder()&#xa;            .codigo(parser.extractField(&#xa;                fixedWidthLine, 1, 10))&#xa;            .nombre(parser.extractField(&#xa;                fixedWidthLine, 11, 50)&#xa;                .trim())&#xa;            .saldoAcueducto(&#xa;                parseCurrency(parser&#xa;                .extractField(fixedWidthLine, &#xa;                51, 62)))&#xa;            .estado(fixedWidthLine.charAt(62))&#xa;            .fechaUltimaConsulta(parseDate(&#xa;                parser.extractField(&#xa;                fixedWidthLine, 64, 71)))&#xa;            .build();&#xa;    }&#xa;}" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;align=left;fontFamily=monospace;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="900" y="220" width="220" height="160" as="geometry" />
        </mxCell>
        
        <!-- JSON OUTPUT -->
        <mxCell id="json_output_title" value="SALIDA JSON UNIFICADA" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=16;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="1200" y="120" width="360" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="json_energia" value="Cliente EnergÃ­a JSON:" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=14;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="1200" y="180" width="170" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="json_energia_sample" value="{&#xa;  &quot;codigo&quot;: &quot;0000012345&quot;,&#xa;  &quot;nombre&quot;: &quot;Juan Carlos Rodriguez&quot;,&#xa;  &quot;saldoEnergia&quot;: 150000.00,&#xa;  &quot;estado&quot;: &quot;ACTIVO&quot;,&#xa;  &quot;fechaUltimoPago&quot;: &quot;2024-12-01&quot;,&#xa;  &quot;tipoServicio&quot;: &quot;ENERGIA&quot;,&#xa;  &quot;timestamp&quot;: &quot;2024-12-15T10:30:00Z&quot;&#xa;}" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontFamily=monospace;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1200" y="220" width="170" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="json_acueducto" value="Cliente Acueducto JSON:" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=14;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="1390" y="180" width="170" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="json_acueducto_sample" value="{&#xa;  &quot;codigo&quot;: &quot;0000023456&quot;,&#xa;  &quot;nombre&quot;: &quot;Maria Fernanda Lopez&quot;,&#xa;  &quot;saldoAcueducto&quot;: 80000.00,&#xa;  &quot;estado&quot;: &quot;ACTIVO&quot;,&#xa;  &quot;fechaUltimaConsulta&quot;: &quot;2024-12-01&quot;,&#xa;  &quot;tipoServicio&quot;: &quot;ACUEDUCTO&quot;,&#xa;  &quot;timestamp&quot;: &quot;2024-12-15T10:30:00Z&quot;&#xa;}" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontFamily=monospace;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1390" y="220" width="170" height="100" as="geometry" />
        </mxCell>
        
        <!-- TRANSFORMATION FLOW -->
        <mxCell id="flow_title" value="FLUJO DE TRANSFORMACIÃ“N" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=16;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="420" width="1480" height="40" as="geometry" />
        </mxCell>
        
        <!-- STEP 1: EXTRACTION -->
        <mxCell id="step1_title" value="1. EXTRACCIÃ“N DE DATOS" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=14;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="480" width="300" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="extraction_details" value="Mainframe (3270 Terminal Emulation):&#xa;â€¢ JCL batch jobs ejecutados nocturnamente&#xa;â€¢ Salida a datasets EBCDIC&#xa;â€¢ Transferencia vÃ­a FTP a staging area&#xa;&#xa;Oracle (PL/SQL Procedures):&#xa;â€¢ UTL_FILE para generar archivos planos&#xa;â€¢ SPOOL files con formato fixed-width&#xa;â€¢ Cron job Linux para recolecciÃ³n" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;align=left;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="80" y="520" width="300" height="120" as="geometry" />
        </mxCell>
        
        <!-- STEP 2: TRANSFORMATION -->
        <mxCell id="step2_title" value="2. TRANSFORMACIÃ“N" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=14;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="420" y="480" width="300" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="transformation_details" value="Message Translator Components:&#xa;â€¢ EbcdicDecoder: IBM EBCDIC â†’ ASCII&#xa;â€¢ FixedWidthParser: Campo posicional&#xa;â€¢ DataTypeConverter: COBOL â†’ Java types&#xa;â€¢ ValidationEngine: Reglas de negocio&#xa;â€¢ JsonSerializer: DTO â†’ JSON&#xa;&#xa;Error Handling:&#xa;â€¢ Invalid data â†’ Dead Letter Queue&#xa;â€¢ Parsing errors â†’ Retry with backoff&#xa;â€¢ Schema validation â†’ Alert admin" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;align=left;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="420" y="520" width="300" height="120" as="geometry" />
        </mxCell>
        
        <!-- STEP 3: DELIVERY -->
        <mxCell id="step3_title" value="3. ENTREGA A MICROSERVICIOS" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=14;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="760" y="480" width="300" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="delivery_details" value="Kafka Event Publishing:&#xa;â€¢ Topic: cliente-energia-updated&#xa;â€¢ Topic: cliente-acueducto-updated&#xa;â€¢ Partitioning por cÃ³digo cliente&#xa;â€¢ Retention: 168 hours (7 days)&#xa;&#xa;Direct API Calls:&#xa;â€¢ Circuit breaker protected&#xa;â€¢ Async processing with CompletableFuture&#xa;â€¢ Bulk operations for performance&#xa;â€¢ Metrics via Micrometer" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="760" y="520" width="300" height="120" as="geometry" />
        </mxCell>
        
        <!-- STEP 4: CACHING -->
        <mxCell id="step4_title" value="4. CACHE Y PERSISTENCIA" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=14;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="1100" y="480" width="300" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="caching_details" value="Redis Distributed Cache:&#xa;â€¢ TTL: 24 horas para consultas&#xa;â€¢ Pattern: cliente:{codigo}:{servicio}&#xa;â€¢ Eviction policy: LRU&#xa;â€¢ Cluster mode para alta disponibilidad&#xa;&#xa;Database Persistence:&#xa;â€¢ PostgreSQL para datos estructurados&#xa;â€¢ MongoDB para documentos JSON&#xa;â€¢ Event sourcing para auditorÃ­a&#xa;â€¢ Backup incremental diario" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;align=left;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="1100" y="520" width="300" height="120" as="geometry" />
        </mxCell>
        
        <!-- TRANSFORMATION RULES -->
        <mxCell id="rules_title" value="REGLAS DE TRANSFORMACIÃ“N Y VALIDACIÃ“N" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=16;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="680" width="1480" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="validation_rules" value="REGLAS DE VALIDACIÃ“N" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=14;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="740" width="460" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="validation_details" value="Validaciones de Datos:&#xa;â€¢ CÃ³digo cliente: 10 dÃ­gitos numÃ©ricos&#xa;â€¢ Saldo: MÃ¡ximo 999,999,999.99&#xa;â€¢ Estado: Solo 'A' (Activo) o 'I' (Inactivo)&#xa;â€¢ Fechas: Formato YYYYMMDD vÃ¡lido&#xa;â€¢ Nombres: Sin caracteres especiales EBCDIC&#xa;&#xa;Transformaciones de Negocio:&#xa;â€¢ Estado 'A' â†’ 'ACTIVO', 'I' â†’ 'INACTIVO'&#xa;â€¢ Saldos negativos â†’ 0.00 (con warning log)&#xa;â€¢ Fechas 00000000 â†’ null&#xa;â€¢ Nombres vacÃ­os â†’ 'CLIENTE SIN NOMBRE'&#xa;â€¢ CÃ³digos duplicados â†’ Usar timestamp como tie-breaker" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;align=left;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="80" y="780" width="460" height="180" as="geometry" />
        </mxCell>
        
        <mxCell id="performance_rules" value="OPTIMIZACIONES DE PERFORMANCE" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=14;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="580" y="740" width="460" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="performance_details" value="Procesamiento en Paralelo:&#xa;â€¢ ThreadPoolExecutor: 8 threads core, 16 max&#xa;â€¢ Batch size: 1000 registros por thread&#xa;â€¢ Memoria heap: -Xmx2G para JVM&#xa;â€¢ NIO2 para lectura de archivos grandes&#xa;&#xa;Streaming Processing:&#xa;â€¢ Apache Kafka Streams para real-time&#xa;â€¢ Windowing: 5 minutos para agregaciones&#xa;â€¢ Checkpointing cada 30 segundos&#xa;â€¢ Exactly-once semantics habilitado&#xa;&#xa;Monitoring:&#xa;â€¢ MÃ©tricas: registros/segundo procesados&#xa;â€¢ Alertas: Si latencia > 30 segundos&#xa;â€¢ Dashboards: Grafana con estado de pipelines" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;align=left;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="580" y="780" width="460" height="180" as="geometry" />
        </mxCell>
        
        <mxCell id="error_handling" value="MANEJO DE ERRORES" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=14;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="1080" y="740" width="460" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="error_details" value="Estrategias de Error:&#xa;â€¢ Parse Error â†’ Dead Letter Queue (DLQ)&#xa;â€¢ Invalid Data â†’ Transformar a default + warning&#xa;â€¢ Network Timeout â†’ Retry 3 veces con exponential backoff&#xa;â€¢ EBCDIC Corruption â†’ Skip record + alert admin&#xa;â€¢ Duplicate Key â†’ Update instead of insert&#xa;&#xa;Recovery Mechanisms:&#xa;â€¢ Dead Letter Queue processing job (diario)&#xa;â€¢ Manual data correction interface&#xa;â€¢ Rollback capability para batch jobs&#xa;â€¢ Emergency fallback a Ãºltimo dataset vÃ¡lido&#xa;&#xa;Alerting:&#xa;â€¢ Slack notification si error rate > 5%&#xa;â€¢ PagerDuty para errores crÃ­ticos&#xa;â€¢ Email digest para administradores" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;align=left;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="1080" y="780" width="460" height="180" as="geometry" />
        </mxCell>
        
        <!-- FLOW ARROWS -->
        <mxCell id="arrow1" style="endArrow=classic;html=1;strokeColor=#b85450;strokeWidth=3;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="300" y="300" as="sourcePoint" />
            <mxPoint x="640" y="300" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow1_label" value="EBCDIC Binary" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontColor=#b85450;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="420" y="280" width="100" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow2" style="endArrow=classic;html=1;strokeColor=#b85450;strokeWidth=3;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="560" y="300" as="sourcePoint" />
            <mxPoint x="900" y="300" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow2_label" value="Fixed Width Text" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontColor=#b85450;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="680" y="280" width="120" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow3" style="endArrow=classic;html=1;strokeColor=#82b366;strokeWidth=3;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="860" y="260" as="sourcePoint" />
            <mxPoint x="1200" y="260" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow3_label" value="JSON" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontColor=#82b366;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="1020" y="240" width="60" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow4" style="endArrow=classic;html=1;strokeColor=#82b366;strokeWidth=3;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1120" y="260" as="sourcePoint" />
            <mxPoint x="1390" y="260" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow4_label" value="JSON" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontColor=#82b366;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="1230" y="240" width="60" height="20" as="geometry" />
        </mxCell>
        
        <!-- LEGEND -->
        <mxCell id="legend_title" value="LEYENDA - PATRONES Y TECNOLOGÃAS" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=16;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="980" width="1480" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="legend_pattern" value="âœ“ Message Translator Pattern" style="rounded=0;whiteSpace=wrap;html=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="80" y="1020" width="180" height="25" as="geometry" />
        </mxCell>
        
        <mxCell id="legend_anticorruption" value="âœ“ Anti-Corruption Layer" style="rounded=0;whiteSpace=wrap;html=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="280" y="1020" width="180" height="25" as="geometry" />
        </mxCell>
        
        <mxCell id="legend_adapter" value="âœ“ Adapter Pattern" style="rounded=0;whiteSpace=wrap;html=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="480" y="1020" width="180" height="25" as="geometry" />
        </mxCell>
        
        <mxCell id="legend_streaming" value="âœ“ Stream Processing" style="rounded=0;whiteSpace=wrap;html=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="680" y="1020" width="180" height="25" as="geometry" />
        </mxCell>
        
        <mxCell id="legend_colors" value="ðŸ”´ Rojo: Legacy Data | ðŸŸ¢ Verde: Transformadores | ðŸŸ¡ Amarillo: JSON Output | ðŸŸ  Naranja: Cache/Storage" style="rounded=0;whiteSpace=wrap;html=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="880" y="1020" width="680" height="25" as="geometry" />
        </mxCell>